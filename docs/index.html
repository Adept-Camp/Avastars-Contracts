<html>

<head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/github.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/twemoji-awesome-clone@1.0.0/twemoji-awesome.css">
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAJ6TrAFy+8QCC0vgA7+/vAC6n7ACE0/gAS2RuAKbU5QDAwMAAv+3+ACek6gApoeYAAAAAAAAAAAAAAAAARERERERERABEREREREREAEREREREREQAREREeIRERABJmZSohUREAERERKolVEQAREREozUVRABJmZRDNlFUAEREREQzZRUAREREREM2W1BJmZmZRDNlxUREREREQzZVREREREREMzVJmZmZmURDM0REREREREQzRERERERERAMAAwAAAAMAAAADAAAAAwAAAAMAAAADAAAAAwAAAAMAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAA" rel="icon" type="image/x-icon" />
    <style>
        aside {
            width: 20%;
            padding: 35px 55px;
            float: left;
        }

        .content table td {
            border: 0px;
        }

        tr {
            line-height: 3em;
        }

        nav.navbar {
            height: 80px;
            padding: 0px 35px;
        }

        div.container {
            float: left;
            width: 60%;
            margin: 35px 5%;
        }

        strong.method {
            font-size: 2em;
            padding-right: 10px;
        }

        a strong {
            color: black;
        }

        small.generated {
            font-size: .65em;
            font-style: italic;
        }

        /*readme*/
        .README li {
            padding: 5px 40px;
        }

        .README h1,.README h2,.README h3,.README h4 {
            margin-block-start: 0.83em;
            margin-block-end: 0.83em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
        }
    </style>
    <title>soldoc</title>
</head>

<body>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://github.com/HQ20/soldoc">
                <h1 class="title is-1">soldoc</h1>
            </a>
        </div>

        <div id="navbarBasicExample" class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item" href="index.html">
                    Home
                </a>

                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                    More soldoc
                    </a>

                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="https://github.com/HQ20/soldoc/wiki/About">
                            About
                        </a>
                        <a class="navbar-item" href="#">
                            Contact
                        </a>
                        <hr class="navbar-divider">
                        <a class="navbar-item" href="https://github.com/HQ20/soldoc/issues">
                            Report an issue
                        </a>
                    </div>
                </div>

            </div>
        </div>
    </nav>
    <aside class="menu">
        <p class="menu-label">AccessControl</p>
        <ul class="menu-list">
            <li><a href="AccessControl.html#upgradeContract">upgradeContract</a></li>
            <li><a href="AccessControl.html#addMinter">addMinter</a></li>
            <li><a href="AccessControl.html#addOwner">addOwner</a></li>
            <li><a href="AccessControl.html#pause">pause</a></li>
            <li><a href="AccessControl.html#unpause">unpause</a></li>
        </ul>
        <p class="menu-label">AvastarMinter</p>
        <ul class="menu-list">
            <li><a href="AvastarMinter.html#setTeleporterContract">setTeleporterContract</a></li>
            <li><a href="AvastarMinter.html#setCurrentGeneration">setCurrentGeneration</a></li>
            <li><a href="AvastarMinter.html#setCurrentSeries">setCurrentSeries</a></li>
            <li><a href="AvastarMinter.html#deposit">deposit</a></li>
            <li><a href="AvastarMinter.html#checkDepositorBalance">checkDepositorBalance</a></li>
            <li><a href="AvastarMinter.html#withdrawDepositorBalance">withdrawDepositorBalance</a></li>
            <li><a href="AvastarMinter.html#checkFranchiseBalance">checkFranchiseBalance</a></li>
            <li><a href="AvastarMinter.html#withdrawFranchiseBalance">withdrawFranchiseBalance</a></li>
            <li><a href="AvastarMinter.html#purchasePrime">purchasePrime</a></li>
            <li><a href="AvastarMinter.html#purchaseReplicant">purchaseReplicant</a></li>
        </ul>
        <p class="menu-label">AvastarState</p>
        <ul class="menu-list">
            <li><a href="AvastarState.html#trackAvastar">trackAvastar</a></li>
        </ul>
        <p class="menu-label">AvastarTeleporter</p>
        <ul class="menu-list">
            <li><a href="AvastarTeleporter.html#isAvastarTeleporter">isAvastarTeleporter</a></li>
            <li><a href="AvastarTeleporter.html#approveTraitAccess">approveTraitAccess</a></li>
            <li><a href="AvastarTeleporter.html#useTraits">useTraits</a></li>
        </ul>
        <p class="menu-label">AvastarTypes</p>
        <ul class="menu-list">
        </ul>
        <p class="menu-label">IAvastarTeleporter</p>
        <ul class="menu-list">
            <li><a href="IAvastarTeleporter.html#isAvastarTeleporter">isAvastarTeleporter</a></li>
            <li><a href="IAvastarTeleporter.html#mintPrime">mintPrime</a></li>
            <li><a href="IAvastarTeleporter.html#mintReplicant">mintReplicant</a></li>
            <li><a href="IAvastarTeleporter.html#ownerOf">ownerOf</a></li>
        </ul>
        <p class="menu-label">PrimeFactory</p>
        <ul class="menu-list">
            <li><a href="PrimeFactory.html#getPrimeByGenerationAndSerial">getPrimeByGenerationAndSerial</a></li>
            <li><a href="PrimeFactory.html#getPrimeByTokenId">getPrimeByTokenId</a></li>
            <li><a href="PrimeFactory.html#mintPrime">mintPrime</a></li>
        </ul>
        <p class="menu-label">ReplicantFactory</p>
        <ul class="menu-list">
            <li><a href="ReplicantFactory.html#getReplicantByGenerationAndSerial">getReplicantByGenerationAndSerial</a></li>
            <li><a href="ReplicantFactory.html#getReplicantByTokenId">getReplicantByTokenId</a></li>
            <li><a href="ReplicantFactory.html#mintReplicant">mintReplicant</a></li>
        </ul>
        <p class="menu-label">TraitFactory</p>
        <ul class="menu-list">
            <li><a href="TraitFactory.html#getTrait">getTrait</a></li>
            <li><a href="TraitFactory.html#getTraitIdByGenerationGeneAndVariation">getTraitIdByGenerationGeneAndVariation</a></li>
            <li><a href="TraitFactory.html#createTrait">createTrait</a></li>
            <li><a href="TraitFactory.html#assembleArt">assembleArt</a></li>
            <li><a href="TraitFactory.html#strConcat">strConcat</a></li>
        </ul>
    </aside>

    <div class="container">
        <div class="README">
            <h1 class="title is-1">Avastars Contracts</h1>
<p>Ethereum-based collectible avatars with on-chain artwork</p>
<h2 class="title is-2">Status</h2>
<h4 class="title is-4">Contract lineage with:</h4>
<ul class="menu-list">
<li>Role based access control and SafeMath via Open Zeppelin</li>
<li>Upgradeability</li>
<li>Pauseability</li>
<li>Trait storage with SVG</li>
<li>Avastar NFT minting with serial that resets to 0 with generation</li>
<li>Separate minter contract</li>
<li><a href="README_Trait_Hash.md">Hashing algorithm</a> for storage of all traits (up to 32 ‘genes’ with up to 256 ‘variations’) in a single 256bit integer</li>
<li><em>And much more!</em></li>
</ul>
<p><img src="AvastarsUML.png" alt="UML"></p>
<h4 class="title is-4">Unit tests that prove:</h4>
<pre class="hljs"><code>  Contract: AccessControl
    ✓ should not allow non-sysadmins to pause the contract (299ms)
    ✓ should allow sysadmin to pause the contract when unpaused (62ms)
    ✓ should not allow non-sysadmins to unpause the contract (78ms)
    ✓ should allow sysadmin to unpause the contract when paused (71ms)
    ✓ should allow sysadmin to add a minter (58ms)
    ✓ should allow sysadmin to add an owner (61ms)
    ✓ should not allow non-sysadmins to set upgrade the contract when unpaused (59ms)
    ✓ should not allow sysadmin to upgrade the contract when unpaused (61ms)
    ✓ should not allow non-sysadmins to upgrade the contract when paused (169ms)
    ✓ should allow sysadmin to upgrade the contract when paused (131ms)
    ✓ should not allow sysadmin to unpause contract after the contract is upgraded (68ms)

  Contract: AvastarMinter
    ✓ should allow anyone to deposit ETH (57ms)
    ✓ should allow another depositor to deposit ETH (55ms)
    ✓ should allow a depositor to check their balance
    ✓ should allow a depositor to deposit more ETH (58ms)
    ✓ should show increased balance for a depositor after depositing more ETH
    ✓ should allow an owner to check the franchise balance, (zero if nothing has been purchased)
    ✓ should allow minter to purchase a prime if purchaser has already deposited ETH (154ms)
    ✓ should allow minter to purchase another prime if purchaser has sufficient ETH remaining (169ms)
    ✓ should show appropriately decreased balance for depositor after purchasing primes
    ✓ should allow a depositor to withdraw a non-zero balance (94ms)
    ✓ should not allow minter to purchase a prime if purchaser has withdrawn their balance (57ms)
    ✓ should allow an owner to check the franchise balance, (has value after purchases)
    ✓ should allow an owner to withdraw the franchise balance (79ms)
    ✓ should allow another depositor to check their balance
    ✓ should allow another depositor to withdraw a non-zero balance (70ms)
    ✓ should not allow non-sysadmins to set current series (65ms)
    ✓ should not allow system administrator to set current series if contract not paused (54ms)
    ✓ should allow system administrator to set current series if paused (142ms)
    ✓ should reflect change of series in newly minted primes (255ms)
    ✓ should not allow non-sysadmins to set current generation (50ms)
    ✓ should not allow system administrator to set current generation if contract not paused (62ms)
    ✓ should allow system administrator to set current generation if paused; series is reset (136ms)
    ✓ should reflect change of generation and series in newly minted primes (217ms)
    ✓ should allow minting of replicants from generation other than current generation (183ms)

  Contract: AvastarTeleporter
    ✓ should not allow system administrator to approve trait access for another user's primes (57ms)
    ✓ should not allow minter to approve trait access for another user's primes (52ms)
    ✓ should allow owner to approve trait access for a specific set of their primes (64ms)
    ✓ should allow a handler to use traits for primes they are approved for (92ms)
    ✓ should not allow a handler to use more traits on a prime without being approved again (51ms)

  Contract: PrimeFactory
    ✓ should not allow system administrator to create a prime (55ms)
    ✓ should not allow non-minters to create a prime (60ms)
    ✓ should allow minter to create a prime (115ms)
    ✓ should allow minter to create a prime in same generation but different series, token id and serial both increase (130ms)
    ✓ should allow minter to create a prime different generation first series, token id increases and serial resets (149ms)
    ✓ should not allow minter to create a prime in the same generation with the same trait hash (60ms)
    ✓ should allow minter to create a prime in a different generation with same trait hash (136ms)
    ✓ should allow anyone to retrieve a prime by generation and serial number (60ms)
    ✓ should allow anyone to retrieve a prime by token id (72ms)

  Contract: ReplicantFactory
    ✓ should not allow system administrator to create a replicant (54ms)
    ✓ should not allow non-minters to create a replicant (59ms)
    ✓ should not allow minter to create a replicant with a hash used by a prime in same generation (56ms)
    ✓ should allow minter to create a replicant (107ms)
    ✓ should allow minter to create a replicant same generation, serial increases (112ms)
    ✓ should allow minter to create a replicant different generation, token id increases and serial resets (115ms)
    ✓ should not allow minter to create a replicant in the same generation with the same trait hash (58ms)
    ✓ should allow minter to create a replicant in a different generation with same trait hash (113ms)
    ✓ should allow anyone to retrieve a replicant by generation and serial number
    ✓ should allow anyone to retrieve a replicant by token id

  Contract: TraitFactory
    ✓ should allow sysadmin to create a trait (647ms)
    ✓ should allow sysadmin to retrieve a trait (148ms)
    ✓ should not allow non-sysadmins to create traits (60ms)
    ✓ should allow non-sysadmins to retrieve a trait (144ms)
    ✓ should allow sysadmin to create and retrieve another trait (608ms)
    ✓ should not allow sysadmin to create trait with bad value for generation (68ms)
    ✓ should not allow sysadmin to create trait with bad value for gender (231ms)
    ✓ should not allow sysadmin to create trait with bad value for gene (141ms)
    ✓ should not allow sysadmin to create trait with empty array for series (74ms)
    ✓ should not allow sysadmin to create trait with bad value for series (90ms)
    ✓ should not allow sysadmin to create trait with bad value for variation (80ms)
    ✓ should not allow sysadmin to create traits when contract is paused (168ms)
    ✓ should allow anyone to retrieve a trait id by generation, gene, and variation
    ✓ should allow anyone to assemble artwork by generation and trait hash (7395ms)

  73 passing (18s)
</code></pre>
<h1 class="title is-1">Developer Setup</h1>
<h2 class="title is-2">Build / Run / Deploy Prerequisites</h2>
<h3 class="title is-3">Install Node (also installs NPM)</h3>
<ul class="menu-list">
<li><a href="https://nodejs.org/en/download/">Node</a> (<a href="https://github.com/trufflesuite/truffle/issues/2070">DO NOT INSTALL VERSION 12</a>! - use 11 or below.)</li>
</ul>
<h2 class="title is-2">Install required Node modules for project</h2>
<p>All NPM resources are project-local. No global installs required. We use <code>npx</code> to run any npm
executables that needs to be started (e.g., Ganache, etc.)</p>
<pre class="hljs"><code>cd path/to/avastars
npm install
</code></pre>
<h1 class="title is-1">Development Tasks</h1>
<h3 class="title is-3">Generate Contract UML</h3>
<p>Generates a <a href="AvastarsUML.png">UML diagram</a> of the Avastars contracts. Only local files, doesn’t include inherited Open Zeppelin stuff unfortunately.</p>
<p><code>npm run uml:generate</code></p>
<h3 class="title is-3">Start Ganache</h3>
<p>An Ethereum client on 127.0.0.1:7545, will start up a local blockchain for testing. It will
create 10 accounts with 100ETH each. We deploy our contract with Account 0.</p>
<p><code>npm run ganache:start</code></p>
<h3 class="title is-3">Start Truffle console</h3>
<p>Communicates with the Ethereum client. It provides us with an interactive console for testing
and migrating contracts, etc. May be a little slow to come up, but it will, eventually.</p>
<p><code>npm run truffle:start</code></p>
<h4 class="title is-4">Compile and migrate contracts, replacing previous deployments</h4>
<p><em>truffle(development)&gt;</em> <code>migrate --reset</code></p>
<h4 class="title is-4">Compile contracts and run tests</h4>
<p><em>truffle(development)&gt;</em> <code>test</code></p>
<h4 class="title is-4">Execute data scripts</h4>
<p><em>truffle(development)&gt;</em> <code>exec data/&lt;script-name&gt;.js</code></p>

        </div>
    </div>
</body>

</html>
